using BcGov.Fams3.Redis;
using BcGov.Fams3.Redis.Model;
using BcGov.Fams3.SearchApi.Contracts.Person;
using BcGov.Fams3.SearchApi.Contracts.PersonSearch;
using Microsoft.Extensions.Logging;
using Microsoft.Extensions.Options;
using Moq;
using Newtonsoft.Json;
using NUnit.Framework;
using SearchApi.Web.Configuration;
using SearchApi.Web.Controllers;
using SearchApi.Web.DeepSearch;
using SearchApi.Web.DeepSearch.Schema;
using SearchApi.Web.Messaging;
using SearchApi.Web.Notifications;
using SearchApi.Web.Test.Utils;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;

namespace SearchApi.Web.Test.DeepSearch
{
    public class DeepSearchServiceTest
    {

        private DeepSearchService _sut;
        private Mock<ILogger<DeepSearchService>> _loggerMock;
        private Mock<ISearchApiNotifier<PersonSearchAdapterEvent>> _searchApiNotifierMock;
        private Mock<IDeepSearchDispatcher> _dispatcherMock;
        private Mock<ICacheService> _cacheServiceMock;
        private Mock<IOptions<DeepSearchOptions>> _deepSearchOptionsMock;
        WaveSearchData wave;
        string dataPartner = "ICBC";
        string SearchRequestKey = "FirstTimeWave";
        string NotSearchRequestKey = "AnotherWave";
        PersonSearchRequest person;
        [SetUp]
        public void SetUp()
        {
            var waveitem1 = "{\"searchRequestKey\":\"searchkey1\",\"currentWave\":2,\"dataPartner\":\"ICBC\",\"allParameter\":[{\"agency\":{\"notes\":\"string\",\"requestPriority\":\"Urgent\",\"code\":\"string\",\"requestId\":\"string\",\"reasonCode\":\"EnfPayAgr\",\"requestDate\":\"2020-09-10T18:53:01.884Z\",\"informationRequested\":[\"string\"],\"agent\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"agentContact\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"email\":\"string\",\"locationCode\":\"string\",\"locationAddress\":\"string\"},\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.884Z\",\"dateOfDeath\":\"2020-09-10T18:53:01.884Z\",\"gender\":\"string\",\"dateDeathConfirmed\":true,\"incacerated\":\"string\",\"height\":\"string\",\"weight\":\"string\",\"hairColour\":\"string\",\"eyeColour\":\"string\",\"complexion\":\"string\",\"distinguishingFeatures\":\"string\",\"wearGlasses\":\"string\",\"type\":\"string\",\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"addresses\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"}],\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"names\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"relatedPersons\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"gender\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.885Z\",\"type\":\"string\"}],\"employments\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"employmentConfirmed\":true,\"incomeAssistance\":true,\"incomeAssistanceStatus\":\"string\",\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"},\"occupation\":\"string\",\"website\":\"string\"}],\"bankInfos\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"}],\"vehicles\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"ownershipType\":\"string\",\"vin\":\"string\",\"plateNumber\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"otherAssets\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"typeDescription\":\"string\",\"referenceDescription\":\"string\",\"referenceValue\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"compensationClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"claimantNumber\":\"string\",\"bankInfo\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"},\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"}}],\"insuranceClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"adjustor\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"adjustorPhone\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"insuredParties\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}],\"claimCentre\":{\"location\":\"string\",\"contactAddress\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactNumber\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}]}}],\"notes\":\"string\",\"searchRequestKey\":\"string\"}],\"newParameter\":[{\"agency\":{\"notes\":\"string\",\"requestPriority\":\"Urgent\",\"code\":\"string\",\"requestId\":\"string\",\"reasonCode\":\"EnfPayAgr\",\"requestDate\":\"2020-09-10T18:53:01.884Z\",\"informationRequested\":[\"string\"],\"agent\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"agentContact\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"email\":\"string\",\"locationCode\":\"string\",\"locationAddress\":\"string\"},\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.884Z\",\"dateOfDeath\":\"2020-09-10T18:53:01.884Z\",\"gender\":\"string\",\"dateDeathConfirmed\":true,\"incacerated\":\"string\",\"height\":\"string\",\"weight\":\"string\",\"hairColour\":\"string\",\"eyeColour\":\"string\",\"complexion\":\"string\",\"distinguishingFeatures\":\"string\",\"wearGlasses\":\"string\",\"type\":\"string\",\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"addresses\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"}],\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"names\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"relatedPersons\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"gender\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.885Z\",\"type\":\"string\"}],\"employments\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"employmentConfirmed\":true,\"incomeAssistance\":true,\"incomeAssistanceStatus\":\"string\",\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"},\"occupation\":\"string\",\"website\":\"string\"}],\"bankInfos\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"}],\"vehicles\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"ownershipType\":\"string\",\"vin\":\"string\",\"plateNumber\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"otherAssets\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"typeDescription\":\"string\",\"referenceDescription\":\"string\",\"referenceValue\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"compensationClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"claimantNumber\":\"string\",\"bankInfo\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"},\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"}}],\"insuranceClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"adjustor\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"adjustorPhone\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"insuredParties\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}],\"claimCentre\":{\"location\":\"string\",\"contactAddress\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactNumber\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}]}}],\"notes\":\"string\",\"searchRequestKey\":\"string\"}],\"numberOfRetries\":2,\"timeBetweenRetries\":40}";
            var waveitem2 = "{\"searchRequestKey\":\"searchkey1\",\"currentWave\":2,\"dataPartner\":\"BCHYDRO\",\"allParameter\":[{\"agency\":{\"notes\":\"string\",\"requestPriority\":\"Urgent\",\"code\":\"string\",\"requestId\":\"string\",\"reasonCode\":\"EnfPayAgr\",\"requestDate\":\"2020-09-10T18:53:01.884Z\",\"informationRequested\":[\"string\"],\"agent\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"agentContact\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"email\":\"string\",\"locationCode\":\"string\",\"locationAddress\":\"string\"},\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.884Z\",\"dateOfDeath\":\"2020-09-10T18:53:01.884Z\",\"gender\":\"string\",\"dateDeathConfirmed\":true,\"incacerated\":\"string\",\"height\":\"string\",\"weight\":\"string\",\"hairColour\":\"string\",\"eyeColour\":\"string\",\"complexion\":\"string\",\"distinguishingFeatures\":\"string\",\"wearGlasses\":\"string\",\"type\":\"string\",\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"addresses\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"}],\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"names\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"relatedPersons\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"gender\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.885Z\",\"type\":\"string\"}],\"employments\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"employmentConfirmed\":true,\"incomeAssistance\":true,\"incomeAssistanceStatus\":\"string\",\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"},\"occupation\":\"string\",\"website\":\"string\"}],\"bankInfos\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"}],\"vehicles\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"ownershipType\":\"string\",\"vin\":\"string\",\"plateNumber\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"otherAssets\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"typeDescription\":\"string\",\"referenceDescription\":\"string\",\"referenceValue\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"compensationClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"claimantNumber\":\"string\",\"bankInfo\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"},\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"}}],\"insuranceClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"adjustor\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"adjustorPhone\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"insuredParties\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}],\"claimCentre\":{\"location\":\"string\",\"contactAddress\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactNumber\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}]}}],\"notes\":\"string\",\"searchRequestKey\":\"string\"}],\"newParameter\":[{\"agency\":{\"notes\":\"string\",\"requestPriority\":\"Urgent\",\"code\":\"string\",\"requestId\":\"string\",\"reasonCode\":\"EnfPayAgr\",\"requestDate\":\"2020-09-10T18:53:01.884Z\",\"informationRequested\":[\"string\"],\"agent\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"agentContact\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"email\":\"string\",\"locationCode\":\"string\",\"locationAddress\":\"string\"},\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.884Z\",\"dateOfDeath\":\"2020-09-10T18:53:01.884Z\",\"gender\":\"string\",\"dateDeathConfirmed\":true,\"incacerated\":\"string\",\"height\":\"string\",\"weight\":\"string\",\"hairColour\":\"string\",\"eyeColour\":\"string\",\"complexion\":\"string\",\"distinguishingFeatures\":\"string\",\"wearGlasses\":\"string\",\"type\":\"string\",\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"addresses\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"}],\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"names\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"relatedPersons\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"gender\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.885Z\",\"type\":\"string\"}],\"employments\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"employmentConfirmed\":true,\"incomeAssistance\":true,\"incomeAssistanceStatus\":\"string\",\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"},\"occupation\":\"string\",\"website\":\"string\"}],\"bankInfos\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"}],\"vehicles\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"ownershipType\":\"string\",\"vin\":\"string\",\"plateNumber\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"otherAssets\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"typeDescription\":\"string\",\"referenceDescription\":\"string\",\"referenceValue\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"compensationClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"claimantNumber\":\"string\",\"bankInfo\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"},\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"}}],\"insuranceClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"adjustor\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"adjustorPhone\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"insuredParties\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}],\"claimCentre\":{\"location\":\"string\",\"contactAddress\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactNumber\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}]}}],\"notes\":\"string\",\"searchRequestKey\":\"string\"}],\"numberOfRetries\":2,\"timeBetweenRetries\":40}";
            var waveitem3 = "{\"searchRequestKey\":\"searchkey1\",\"currentWave\":2,\"dataPartner\":\"MHSD\",\"allParameter\":[{\"agency\":{\"notes\":\"string\",\"requestPriority\":\"Urgent\",\"code\":\"string\",\"requestId\":\"string\",\"reasonCode\":\"EnfPayAgr\",\"requestDate\":\"2020-09-10T18:53:01.884Z\",\"informationRequested\":[\"string\"],\"agent\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"agentContact\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"email\":\"string\",\"locationCode\":\"string\",\"locationAddress\":\"string\"},\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.884Z\",\"dateOfDeath\":\"2020-09-10T18:53:01.884Z\",\"gender\":\"string\",\"dateDeathConfirmed\":true,\"incacerated\":\"string\",\"height\":\"string\",\"weight\":\"string\",\"hairColour\":\"string\",\"eyeColour\":\"string\",\"complexion\":\"string\",\"distinguishingFeatures\":\"string\",\"wearGlasses\":\"string\",\"type\":\"string\",\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"addresses\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"}],\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"names\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"relatedPersons\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"gender\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.885Z\",\"type\":\"string\"}],\"employments\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"employmentConfirmed\":true,\"incomeAssistance\":true,\"incomeAssistanceStatus\":\"string\",\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"},\"occupation\":\"string\",\"website\":\"string\"}],\"bankInfos\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"}],\"vehicles\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"ownershipType\":\"string\",\"vin\":\"string\",\"plateNumber\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"otherAssets\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"typeDescription\":\"string\",\"referenceDescription\":\"string\",\"referenceValue\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"compensationClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"claimantNumber\":\"string\",\"bankInfo\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"},\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"}}],\"insuranceClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"adjustor\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"adjustorPhone\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"insuredParties\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}],\"claimCentre\":{\"location\":\"string\",\"contactAddress\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactNumber\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}]}}],\"notes\":\"string\",\"searchRequestKey\":\"string\"}],\"newParameter\":[{\"agency\":{\"notes\":\"string\",\"requestPriority\":\"Urgent\",\"code\":\"string\",\"requestId\":\"string\",\"reasonCode\":\"EnfPayAgr\",\"requestDate\":\"2020-09-10T18:53:01.884Z\",\"informationRequested\":[\"string\"],\"agent\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"agentContact\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"email\":\"string\",\"locationCode\":\"string\",\"locationAddress\":\"string\"},\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.884Z\",\"dateOfDeath\":\"2020-09-10T18:53:01.884Z\",\"gender\":\"string\",\"dateDeathConfirmed\":true,\"incacerated\":\"string\",\"height\":\"string\",\"weight\":\"string\",\"hairColour\":\"string\",\"eyeColour\":\"string\",\"complexion\":\"string\",\"distinguishingFeatures\":\"string\",\"wearGlasses\":\"string\",\"type\":\"string\",\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"addresses\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"}],\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"names\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.884Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"relatedPersons\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"gender\":\"string\",\"dateOfBirth\":\"2020-09-10T18:53:01.885Z\",\"type\":\"string\"}],\"employments\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"employmentConfirmed\":true,\"incomeAssistance\":true,\"incomeAssistanceStatus\":\"string\",\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"},\"occupation\":\"string\",\"website\":\"string\"}],\"bankInfos\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"}],\"vehicles\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"ownershipType\":\"string\",\"vin\":\"string\",\"plateNumber\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"otherAssets\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"typeDescription\":\"string\",\"referenceDescription\":\"string\",\"referenceValue\":\"string\",\"owners\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}]}],\"compensationClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"claimantNumber\":\"string\",\"bankInfo\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"bankName\":\"string\",\"branch\":\"string\",\"transitNumber\":\"string\",\"accountNumber\":\"string\"},\"employer\":{\"name\":\"string\",\"ownerName\":\"string\",\"phones\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}],\"address\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactPerson\":\"string\"}}],\"insuranceClaims\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"claimType\":\"string\",\"claimStatus\":\"string\",\"claimNumber\":\"string\",\"adjustor\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"adjustorPhone\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"identifiers\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"value\":\"string\",\"type\":\"BCDriverLicense\",\"typeCode\":\"string\",\"issuedBy\":\"string\",\"owner\":\"Applicant\"}],\"insuredParties\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"name\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"firstName\":\"string\",\"lastName\":\"string\",\"middleName\":\"string\",\"otherName\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"},\"type\":\"string\",\"typeDescription\":\"string\",\"organization\":\"string\"}],\"claimCentre\":{\"location\":\"string\",\"contactAddress\":{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"type\":\"string\",\"addressLine1\":\"string\",\"addressLine2\":\"string\",\"addressLine3\":\"string\",\"stateProvince\":\"string\",\"city\":\"string\",\"countryRegion\":\"string\",\"zipPostalCode\":\"string\",\"owner\":\"Applicant\"},\"contactNumber\":[{\"referenceDates\":[{\"index\":0,\"key\":\"string\",\"value\":\"2020-09-10T18:53:01.885Z\"}],\"description\":\"string\",\"notes\":\"string\",\"phoneNumber\":\"string\",\"extension\":\"string\",\"type\":\"string\",\"owner\":\"Applicant\"}]}}],\"notes\":\"string\",\"searchRequestKey\":\"string\"}],\"numberOfRetries\":2,\"timeBetweenRetries\":40}";
            _loggerMock = LoggerUtils.LoggerMock<DeepSearchService>();
            _deepSearchOptionsMock = new Mock<IOptions<DeepSearchOptions>>();
            _cacheServiceMock = new Mock<ICacheService>();
            _searchApiNotifierMock = new Mock<ISearchApiNotifier<PersonSearchAdapterEvent>>();
            _dispatcherMock = new Mock<IDeepSearchDispatcher>();
            _cacheServiceMock.Setup(x => x.Get($"deepsearch-{SearchRequestKey}-{dataPartner}"))
                .Returns(Task.FromResult(""));
            _deepSearchOptionsMock.Setup(x => x.Value).Returns(new DeepSearchOptions
            {
                MaxWaveCount = 5
            });
            wave = new WaveSearchData
            {
                AllParameter = new List<Person>(),
                CurrentWave = 2,
                DataPartner = dataPartner,
                NewParameter = new List<Person>(),
                SearchRequestKey = SearchRequestKey,
                NumberOfRetries = 1,
                TimeBetweenRetries = 3
            };
            _cacheServiceMock.Setup(x => x.Get($"deepsearch-{NotSearchRequestKey}-{dataPartner}"))
                .Returns(Task.FromResult(JsonConvert.SerializeObject(wave)));
            person = new PersonSearchRequest(
                "firstname",
                "lastname",
                DateTime.Now,
                new List<PersonalIdentifier>(),
                new List<Address>(),
                new List<Phone>(),
                new List<Name>(),
                new List<RelatedPerson>(),
                new List<Employment>(),
                new List<DataProvider>(),
                SearchRequestKey);

            _cacheServiceMock.Setup(x => x.SaveRequest(It.IsAny<SearchRequest>()))
                .Returns(Task.FromResult(0));

            _cacheServiceMock.Setup(x => x.GetRequest(It.IsAny<string>()))
            .Returns(Task.FromResult(new SearchRequest { DataPartners = new List<DataPartner>() { new DataPartner { Completed = false, Name = "ICBC" }, } }));

            _cacheServiceMock.Setup(x => x.SearchKeys("null*"))
           .Returns(Task.FromResult(new List<string>() { }.AsEnumerable()));

            _cacheServiceMock.Setup(x => x.GetRequest("continuewave"))
            .Returns(Task.FromResult(new SearchRequest { DataPartners = new List<DataPartner>() { new DataPartner { Completed = true, Name = "ICBC" }, new DataPartner { Completed = true, Name = "BCHYDRO" } } }));

            _cacheServiceMock.Setup(x => x.SearchKeys("mykey*"))
           .Returns(Task.FromResult(new List<string>() { "first", "second", "third" }.AsEnumerable()));
            _cacheServiceMock
                .Setup(x => x.DeleteRequest(It.IsAny<string>()))
                .Returns(Task.CompletedTask);

            _cacheServiceMock
              .Setup(x => x.Delete(It.IsAny<string>()))
              .Returns(Task.CompletedTask);

            _cacheServiceMock.Setup(x => x.Get("first"))
          .Returns(Task.FromResult(waveitem1));
            _cacheServiceMock.Setup(x => x.Get("second"))
          .Returns(Task.FromResult(waveitem2));
            _cacheServiceMock.Setup(x => x.Get("third"))
      .Returns(Task.FromResult(waveitem3));
            _deepSearchOptionsMock.Setup(x => x.Value).Returns(new DeepSearchOptions { MaxWaveCount = 4 });

            _searchApiNotifierMock
                .Setup(x => x.NotifyEventAsync(It.IsAny<string>(), It.IsAny<PersonSearchAdapterEvent>(), It.IsAny<string>(), It.IsAny<CancellationToken>()))
                .Returns(Task.CompletedTask);

            _dispatcherMock.Setup(x => x.Dispatch(It.IsAny<string>(), It.IsAny<WaveSearchData>(), It.IsAny<Person>()))
                .Returns(Task.CompletedTask);

            _sut = new DeepSearchService(_cacheServiceMock.Object, _loggerMock.Object, _deepSearchOptionsMock.Object, _searchApiNotifierMock.Object, _dispatcherMock.Object);

        }



        [Test]
        public async Task should_not_update_partner_with_is_accepted()
        {
            await _sut.UpdateDataPartner("mykey", "ICBC", "Accepted");
            await _sut.UpdateDataPartner("mykey", "ICBC", "Submitted");
            await _sut.UpdateDataPartner("mykey", "ICBC", "Finalized");
            _cacheServiceMock.Verify(x => x.SaveRequest(It.IsAny<SearchRequest>()), Times.Never());
        }

        [Test]
        public async Task should_update_partner_with_failed_completed_rejected()
        {
            await _sut.UpdateDataPartner("mykey", "ICBC", "Failed");
            await _sut.UpdateDataPartner("mykey", "ICBC", "Completed");
            await _sut.UpdateDataPartner("mykey", "ICBC", "Rejected");
            _cacheServiceMock.Verify(x => x.GetRequest(It.IsAny<string>()), Times.Exactly(3));
            _cacheServiceMock.Verify(x => x.SaveRequest(It.IsAny<SearchRequest>()), Times.Exactly(3));
        }

        [Test]
        public async Task should_process_wave_search_initiate_new_wave()
        {
            _deepSearchOptionsMock.Setup(x => x.Value).Returns(new DeepSearchOptions
            {
                MaxWaveCount = 5
            });

            _sut = new DeepSearchService(_cacheServiceMock.Object, _loggerMock.Object, _deepSearchOptionsMock.Object, _searchApiNotifierMock.Object, _dispatcherMock.Object);

            await _sut.ProcessWaveSearch("mykey");

            _cacheServiceMock.Verify(x => x.GetRequest(It.IsAny<string>()), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.SearchKeys("mykey*"), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.Get("first"), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.Get("second"), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.Get("third"), Times.Exactly(1));
            _dispatcherMock.Verify(x => x.Dispatch(It.IsAny<string>(), It.IsAny<WaveSearchData>(), It.IsAny<Person>()), Times.Exactly(3));
        }

        [Test]
        public async Task should_finalize_wave_search_when_maxwave_reached()
        {
            _deepSearchOptionsMock.Setup(x => x.Value).Returns(new DeepSearchOptions
            {
                MaxWaveCount = 2
            });

            _sut = new DeepSearchService(_cacheServiceMock.Object, _loggerMock.Object, _deepSearchOptionsMock.Object, _searchApiNotifierMock.Object, _dispatcherMock.Object);

            await _sut.ProcessWaveSearch("mykey");

            _cacheServiceMock.Verify(x => x.GetRequest(It.IsAny<string>()), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.SearchKeys("mykey*"), Times.Exactly(2));
            _cacheServiceMock.Verify(x => x.Get("first"), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.Get("second"), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.Get("third"), Times.Exactly(1));
            _searchApiNotifierMock
               .Verify(x => x.NotifyEventAsync(It.IsAny<string>(), It.IsAny<PersonSearchAdapterEvent>(), It.IsAny<string>(), It.IsAny<CancellationToken>()), Times.Exactly(1));
            _cacheServiceMock.Verify(x => x.Delete(It.IsAny<string>()), Times.Exactly(3));
            _cacheServiceMock.Verify(x => x.DeleteRequest(It.IsAny<string>()), Times.Exactly(1));
        }

        [Test]
        public void should_throw_exception_if_wave_data_not_found()
        {

            Assert.ThrowsAsync<InvalidOperationException>(async () => await _sut.ProcessWaveSearch("null"));
        }
    }
}

